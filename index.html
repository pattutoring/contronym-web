<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Contronym — Contronym Game</title>
<style>
  :root{
    --bg:#f9f7f2; --ink:#222; --accent:#00bfff; --xaxis:#000; --yaxis:#c02020;
  }
  html,body{height:100%;margin:0}
  body{
    font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:var(--bg);
    color:var(--ink);
    padding:36px 16px 48px;
    display:flex;
    flex-direction:column;
    align-items:center;
    box-sizing:border-box;
    gap:6px;
  }
  h1{font-size:2rem;margin:0}
  h2{font-size:1rem;margin:0;color:#555;font-style:italic}

  .game-container{
    width:460px;
    max-width:calc(100% - 32px);
    position:relative;
    box-sizing:border-box;
  }

  /* SVG will be tall so vertex can be pushed down */
  svg{width:100%;display:block}

  .answers{display:flex;justify-content:center;gap:6px;margin-top:8px}
  .letter-box{
    width:40px;height:40px;border-radius:6px;border:1px solid #444;
    font-family:monospace;font-size:18px;text-align:center;background:#fff;box-sizing:border-box;
  }

  .controls{display:flex;gap:10px;justify-content:center;margin-top:10px}
  button{padding:8px 12px;border-radius:8px;border:1px solid #bbb;background:#eee;cursor:pointer}
  #hint-text{display:none;margin-top:10px;font-style:italic;color:#666;text-align:center;max-width:420px}
  #message{margin-top:8px;text-align:center;color:#007766;font-style:italic;min-height:1.2em}

  /* admin-in-code note small */
  .note{font-size:0.82rem;color:#666;margin-top:10px;text-align:center}
</style>
</head>
<body>
  <h1>Contronym</h1>
  <h2>The Majorana of Meaning</h2>

  <div class="game-container">
    <!-- big SVG so vertex can be moved way down (moved 200px relative to earlier small graphs) -->
    <!-- viewBox height large (0..0..400..600) so we can place vertex near bottom -->
    <svg id="graph" viewBox="0 0 400 600" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <!-- axis lines inside svg (x-axis near bottom at y=560) -->
      <line x1="0"   y1="560" x2="400" y2="560" stroke="var(--xaxis)" stroke-width="3"/>
      <line x1="200" y1="0"   x2="200" y2="600" stroke="var(--yaxis)" stroke-width="3"/>

      <!-- parabola: left end y=120, right end y=120, control/vertex Y set very low (approx 520) -->
      <!-- moved vertex DOWN strongly (control y = 520) to approximate +200px shift -->
      <path id="parabola" d="M 120 120 Q 200 520 280 120"
            stroke="var(--accent)" stroke-width="4" stroke-dasharray="8 6" fill="none" stroke-linecap="round"/>

      <!-- side labels placed by JS (will follow ends of parabola) -->
      <text id="leftLabel" x="0" y="0" font-size="16" font-style="italic" text-anchor="end" fill="#111">permit</text>
      <text id="rightLabel" x="0" y="0" font-size="16" font-style="italic" text-anchor="start" fill="#111">restrict</text>

      <!-- axis labels -->
      <text x="380" y="552" font-size="13" font-style="italic" text-anchor="end" fill="#000">transverse</text>
      <text x="210" y="20" font-size="13" font-style="italic" text-anchor="start" fill="#000">conjugate</text>
    </svg>
  </div>

  <div class="answers" id="answerBoxes" aria-label="answer boxes"></div>

  <div class="controls">
    <button id="showHintBtn">Show Hint</button>
    <button id="clearBtn">Clear</button>
  </div>

  <div id="hint-text" role="note"></div>
  <div id="message" role="status"></div>

  <div class="note">(To change the word/side labels/hint, edit the constants in the script at top of the file.)</div>

<script>
/* ============================
 Editable constants (change these directly in the file)
 ============================ */
const WORD = "SANCTION";   // answer (uppercase recommended)
const SIDE_LEFT = "permit";
const SIDE_RIGHT = "restrict";
const HINT_TEXT = "A word that both authorizes and penalizes an action.";
/* ============================ */

const parabola = document.getElementById('parabola');
const leftLabel = document.getElementById('leftLabel');
const rightLabel = document.getElementById('rightLabel');
const answerBoxes = document.getElementById('answerBoxes');
const hintTextElt = document.getElementById('hint-text');
const messageElt = document.getElementById('message');

hintTextElt.textContent = HINT_TEXT;
leftLabel.textContent = SIDE_LEFT;
rightLabel.textContent = SIDE_RIGHT;

// place side labels at parabola ends (just outside)
function placeSideLabels(){
  const path = parabola;
  const len = path.getTotalLength();
  const leftPoint = path.getPointAtLength(0);
  const rightPoint = path.getPointAtLength(len);

  // place slightly above and outside ends
  leftLabel.setAttribute('x', leftPoint.x - 12);
  leftLabel.setAttribute('y', leftPoint.y - 12);

  rightLabel.setAttribute('x', rightPoint.x + 12);
  rightLabel.setAttribute('y', rightPoint.y - 12);
}

// build letter input boxes
function buildAnswerBoxes(){
  answerBoxes.innerHTML = '';
  const w = (WORD || '').toUpperCase();
  for(let i=0;i<w.length;i++){
    const inp = document.createElement('input');
    inp.type = 'text';
    inp.maxLength = 1;
    inp.className = 'letter-box';
    inp.dataset.idx = i;
    inp.autocomplete = 'off';
    inp.spellcheck = false;
    inp.addEventListener('input', onInput);
    inp.addEventListener('keydown', onKeyDown);
    answerBoxes.appendChild(inp);
  }
  // focus first
  const first = answerBoxes.querySelector('input');
  if(first) first.focus();
}

function onInput(e){
  const t = e.target;
  t.value = (t.value || '').toUpperCase();
  const idx = Number(t.dataset.idx);
  if(t.value.length === 1){
    const next = answerBoxes.querySelector(`input[data-idx="${idx+1}"]`);
    if(next) next.focus();
  }
  checkAnswer();
}

function onKeyDown(e){
  const t = e.target;
  const idx = Number(t.dataset.idx);
  if(e.key === 'Backspace' && !t.value){
    const prev = answerBoxes.querySelector(`input[data-idx="${idx-1}"]`);
    if(prev){ prev.focus(); prev.value=''; e.preventDefault(); }
  }
}

function checkAnswer(){
  const inputs = answerBoxes.querySelectorAll('input');
  let got = '';
  inputs.forEach(i=> got += (i.value || ''));
  if(got.length === WORD.length && got === WORD){
    messageElt.textContent = "Clever — you found the inversion. Like a Majorana neutrino, it is its own antineutrino.";
  } else {
    messageElt.textContent = '';
  }
}

// hint button
document.getElementById('showHintBtn').addEventListener('click', ()=>{
  hintTextElt.style.display = 'block';
});

// clear button
document.getElementById('clearBtn').addEventListener('click', ()=>{
  answerBoxes.querySelectorAll('input').forEach(i=> i.value='');
  messageElt.textContent = '';
  const first = answerBoxes.querySelector('input');
  if(first) first.focus();
});

// initial build and placement
placeSideLabels();
buildAnswerBoxes();

// reposition labels on resize (svg scales)
window.addEventListener('resize', placeSideLabels);
</script>
</body>
</html>
